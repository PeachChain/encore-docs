---
title: "Tracking Entitlements"
---

Monitor promotional rewards and temporary access in real-time to adapt your UI and user experience.

## Overview

Encore tracks earned entitlements automatically, including free trials, discounts, and credits. You can check entitlement status anywhere in your app to display promotional badges, show reward status, or highlight temporary access periods.

---

## Entitlement Types

Encore supports three types of promotional rewards:

- **`.freeTrial()`** - Time-limited promotional access (e.g., "7-day trial")
- **`.discount()`** - Percentage or dollar-based subscription discounts
- **`.credit()`** - Account credits that can be applied to purchases

---

## Entitlement Scopes

When checking entitlements, you can specify which scope to use:

### `.verified` 

Only counts entitlements that have been verified (user completed the conversion action):

```swift
let hasActiveTrial = Encore.shared.isActive(.freeTrial(), in: .verified)
// Returns true only if user completed the conversion
```

### `.all`

Counts both verified AND provisional entitlements. Useful for optimistic UI updates for better UX:

```swift
let hasActiveTrial = Encore.shared.isActive(.freeTrial(), in: .all)
// Returns true even if user hasn't converted yet
```

---

## Using with Your Entitlement Manager

The most common pattern is to integrate Encore promotional rewards with your existing subscription/entitlement manager. This keeps your access logic centralized and combines IAP subscriptions with Encore promotional rewards.

### Basic Setup

Create a centralized manager that tracks both IAP subscriptions and Encore promotional rewards:

```swift
import Foundation
import Encore
import Combine

@Observable
class EntitlementManager {
    var hasProAccess: Bool = false
    private var cancellables = Set<AnyCancellable>()
    
    init() {
        // Combine IAP subscription status with Encore promotional rewards
        Publishers.CombineLatest(
            yourIAPManager.subscriptionStatusPublisher,
            Encore.shared.isActivePublisher(for: .freeTrial(), in: .verified)
        )
        .map { iapActive, encoreActive in
            // User has pro access if EITHER they have an active IAP subscription
            // OR they have an active Encore promotional reward
            return iapActive || encoreActive
        }
        .assign(to: \.hasProAccess, on: self)
        .store(in: &cancellables)
    }
}
```

### Usage in SwiftUI

Once your entitlement manager is set up, use it throughout your app:

```swift
import SwiftUI

@main
struct YourApp: App {
    @StateObject private var entitlements = EntitlementManager()
    
    var body: some Scene {
        WindowGroup {
            ContentView()
                .environmentObject(entitlements)
        }
    }
}

struct ContentView: View {
    @EnvironmentObject var entitlements: EntitlementManager
    
    var body: some View {
        VStack {
            if entitlements.hasProAccess {
                // Show premium content
                PremiumContentView()
            } else {
                // Show paywall
                SubscriptionPaywallView()
            }
        }
    }
}
```

---

## Checking Entitlement Status

### Simple Boolean Check

The easiest way to check if a user has an active promotional reward:

```swift
import Encore

// Check for active free trial (verified only)
let hasVerifiedTrial = Encore.shared.isActive(.freeTrial(), in: .verified)

// Check for any active trial (verified or provisional)
let hasAnyTrial = Encore.shared.isActive(.freeTrial(), in: .all)
```

### Using Combine Publishers

For reactive apps, subscribe to entitlement changes:

```swift
import Combine
import Encore

class RewardManager: ObservableObject {
    @Published var hasActiveReward = false
    private var cancellables = Set<AnyCancellable>()
    
    init() {
        // Subscribe to promotional access changes
        Encore.shared.isActivePublisher(for: .freeTrial(), in: .verified)
            .assign(to: \.hasActiveReward, on: self)
            .store(in: &cancellables)
    }
}
```

### Using Delegate Pattern

For UIKit apps or non-Combine architectures:

```swift
import Encore

class SubscriptionManager: EncoreDelegate {
    var hasPromotionalAccess = false
    
    init() {
        // Set delegate
        Encore.shared.entitlementsDelegate = self
        
        // Initial check
        hasPromotionalAccess = Encore.shared.isActive(.freeTrial(), in: .verified)
    }
    
    // Delegate method called when entitlements change
    func encoreDidChangeEntitlement(
        _ isActive: Bool,
        for type: EntitlementType,
        in scope: EntitlementScope
    ) {
        if type == .freeTrial && scope == .verified {
            hasPromotionalAccess = isActive
            
            // Update UI or notify observers
            NotificationCenter.default.post(
                name: .promotionalAccessChanged,
                object: nil,
                userInfo: ["hasAccess": isActive]
            )
        }
    }
}
```

---

## Common Patterns

### Promotional Badge Display

Show reward status in your UI:

```swift
struct ProfileView: View {
    @State private var rewardStatus: String = "Standard"
    
    var body: some View {
        VStack {
            Text("Account Status: \(rewardStatus)")
                .font(.headline)
        }
        .onAppear {
            updateStatus()
        }
        .onReceive(
            Encore.shared.isActivePublisher(for: .freeTrial(), in: .verified)
        ) { _ in
            updateStatus()
        }
    }
    
    private func updateStatus() {
        if Encore.shared.isActive(.freeTrial(), in: .verified) {
            rewardStatus = "Free Trial Active üéâ"
        } else if Encore.shared.isActive(.discount(), in: .verified) {
            rewardStatus = "Discount Available"
        } else {
            rewardStatus = "Standard"
        }
    }
}
```

---

## Best Practices

### ‚úÖ DO

```swift
// ‚úÖ Subscribe to changes for reactive UI
.onReceive(Encore.shared.isActivePublisher(for: .freeTrial(), in: .verified)) { isActive in
    self.hasReward = isActive
}

// ‚úÖ Check on appear for initial state
.onAppear {
    hasReward = Encore.shared.isActive(.freeTrial(), in: .verified)
}

// ‚úÖ Combine with IAP subscription status
let hasAccess = hasIAPSubscription || hasEncoreReward
```

### ‚ùå DON'T

```swift
// ‚ùå Don't cache status without updates
let hasReward = Encore.shared.isActive(.freeTrial(), in: .verified)
// This value becomes stale - use publisher instead
```

---

## Next Steps

- [Presenting Offers](./presenting-offers.mdx) - Show retention offers to users
- [User Management](./user-management.mdx) - Identify users, set attributes, and manage sessions
