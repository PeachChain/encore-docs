---
title: "User Management"
---

Identifying users and managing their identity in your iOS app

---

## Overview

Encore requires user identification to track entitlements and prevent abuse across devices. Proper user management ensures that promotional access is correctly attributed and synchronized.

---

## Anonymous Users

Encore **automatically generates** a random user ID that persists until the user deletes/reinstalls your app or calls `reset()`.

This anonymous ID is stored securely and allows entitlement tracking to work immediately without requiring explicit user identification. The auto-generated ID is a standard UUID (e.g., `550e8400-e29b-41d4-a716-446655440000`).

You can call `Encore.shared.reset()` to reset this ID and clear any entitlement data.

---

## Identified Users

If you use your own user management system, call `identify(userId:)` when you have a user's identity. This will alias your `userId` with the anonymous Encore ID, enabling the SDK to:

- Associate promotional access with your user account
- Sync entitlements across devices when the user logs in
- Track conversion attribution accurately

```swift
// After retrieving a user's ID from login or account creation
Encore.shared.identify(userId: user.id)
```

Calling `identify()` replaces the anonymous ID with your user's actual ID, allowing for proper cross-device entitlement management.

### Resetting User Identity

When a user logs out, call `reset()`:

```swift
// When the user signs out
Encore.shared.reset()
```

This will:
- Reset the user ID to a new auto-generated anonymous ID
- Clear cached entitlement data
- Clear paywall/offer assignments

---

## Best Practices for User IDs

### ✅ Do

- Use a **stable, unique identifier** per user (e.g., database ID, UUID)
- Call `identify()` **after authentication** for proper cross-device entitlement sync
- Let anonymous users access entitlements without requiring login first

### ❌ Don't

- Use **guessable IDs** – they are public-facing
- Use **emails** as user IDs – this isn't GDPR compliant
- Use **IDFA or device IDs** – these are device-specific and easily rotated by the OS
- **Hardcode** strings as user IDs – every user will be treated as the same user

---

## Implementation Examples

### SwiftUI - Optional Login Flow

```swift
import SwiftUI
import Encore

@main
struct YourApp: App {
    @StateObject private var authManager = AuthManager()

    init() {
        Encore.shared.configure(apiKey: "pk_your_api_key")
        // SDK auto-generates an anonymous user ID
    }

    var body: some Scene {
        WindowGroup {
            MainAppView()
                .onAppear {
                    // Only identify if user is logged in
                    if authManager.isAuthenticated {
                        Encore.shared.identify(userId: authManager.userId)
                    }
                    // If not logged in, SDK uses anonymous ID automatically
                }
        }
    }
}
```

### UIKit - Login Flow

```swift
class LoginViewController: UIViewController {
    
    func handleSuccessfulLogin(user: User) {
        // After successful authentication, identify the user
        Encore.shared.identify(userId: user.id)
        navigateToMainApp()
    }
    
    func handleLogout() {
        // Reset to anonymous user
        Encore.shared.reset()
        navigateToLogin()
    }
}
```

### Anonymous-First App (No Login Required)

```swift
import Encore

@main
class AppDelegate: UIResponder, UIApplicationDelegate {
    func application(
        _ application: UIApplication,
        didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
    ) -> Bool {
        // Configure SDK - anonymous ID is auto-generated
        Encore.shared.configure(apiKey: "pk_your_api_key")
        
        // No need to call identify() - SDK works immediately!
        return true
    }
}
```

---

## When to Call identify()

| Scenario | Action |
|----------|--------|
| **App Launch** (user already logged in) | Call `identify()` with their user ID |
| **After Login** | Call `identify()` immediately after successful authentication |
| **After Signup** | Call `identify()` immediately after account creation |
| **Anonymous Users** | No need to call `identify()` - SDK auto-generates an ID |
| **Cross-Device Sync** | Call `identify()` to sync entitlements across devices |

---

## When to Call reset()

| Scenario | Action |
|----------|--------|
| **User Logout** | Call `reset()` to clear user data |
| **Account Switching** | Call `reset()`, then `identify()` with new user ID |
| **Testing** | Call `reset()` to clear test data between sessions |

---

## Verification

After configuring the SDK, you should see this in your console:

```
✅ [Encore] EntitlementManager initialized for hybrid entitlement tracking
🆔 [ENTITLEMENTS] Generated new anonymous user ID
```

If you call `identify()` with a specific user ID, you'll see:

```
🔄 [ENTITLEMENTS] REFRESH UserId changed from '550e8400-...' to 'user_abc123' - refreshing
```

These messages confirm user identification is working correctly! ✅

---

## Next Steps

Now that users are identified, you're ready to:

- [Check Entitlements](./checking-entitlements) - Learn how to check user entitlements
- [Present Offers](./presenting-offers) - Show promotional offers to your users

For further help, check out our [example apps](../EncoreSwiftUIDemo) for working implementations of user management.